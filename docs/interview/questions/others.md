---
id: others
title: 其他
---

import TOCInline from '@theme/TOCInline';

<TOCInline toc={toc} />

### 谈一谈浏览器的缓存机制？

浏览器的缓存机制指的是通过在一段时间内保留已接收到的 web 资源的一个副本，如果在资源的有效时间内，发起了对这个资源的再一次请求，那么浏览器会直接使用缓存的副本，而不是向服务器发起请求。使用 web 缓存可以有效地提高页面的打开速度，减少不必要的网络带宽的消耗。web 资源的缓存策略一般由服务器来指定，可以分为两种，分别是**强缓存**策略和**协商缓存**策略。

使用强缓存策略时，如果命中缓存规则，则直接使用缓存资源，不必再向服务器发起请求。强缓存策略可以通过两种方式来设置，分别是 http 头信息中的 `Expires` 和 `Cache-Control` 属性。服务器通过在响应头中添加 `Expires`(HTTP/1.0) 属性，来指定资源的过期时间。在过期时间以内，该资源可以被缓存使用，不必再向服务器发送请求。这个时间是一个绝对时间，它是服务器的时间，因此可能存在这样的问题，就是客户端的时间和服务器端的时间不一致，或者用户可以对客户端时间进行修改的情况，这样就可能会影响缓存命中的结果。另一个方式是设置 `Cache-Control`(HTTP/1.1) 属性，它提供了对资源的缓存的更精确的控制。一般来说只需要设置其中一种方式就可以实现强缓存策略，当两种方式一起使用时，`Cache-Control` 的优先级要高于 `Expires`。

使用协商缓存策略时，会先向服务器发送一个请求，如果资源没有发生修改，则返回一个 304 状态，让浏览器使用本地的缓存副本，如果资源发生了修改，则返回修改后的资源。协商缓存也可以通过两种方式来设置，分别是 http 头信息中的 `Last-Modified` 和 `Etag` 属性。服务器通过在响应头中添加 `Last-Modified`(HTTP/1.0) 属性来指出资源最后一次修改的时间，当浏览器下一次发起请求时，会在请求头中添加一个 `If-Modified-Since` 的属性，属性值为上一次资源返回时的 `Last-Modified` 的值。服务器会通过这个属性来和资源的最后一次的修改时间来进行比较，以此来判断资源是否做了修改。如果资源没有修改，那么返回 304 状态，让客户端使用本地的缓存。如果资源已经被修改了，则返回修改后的资源。使用这种方法有一个缺点，就是 `Last-Modified` 标注的最后修改时间只能精确到秒级，如果某些文件在 1 秒钟以内，被修改多次的话，那么文件已将改变了但是 `Last-Modified` 却没有改变，这样会造成缓存命中的不准确。另一个方式是设置 `Etag` 属性，它是资源生成的唯一标识符，当资源发生改变的时候，这个值也会发生改变。在下一次资源请求时，浏览器会在请求头中添加一个 `If-None-Match` 属性，这个属性的值就是上次返回的资源的 `Etag` 的值。服务接收到请求后会根据这个值来和资源当前的 `Etag` 的值来进行比较，以此来判断资源是否发生改变，是否需要返回资源。通过这种方式，比 `Last-Modified` 的方式更加精确。当 `Last-Modified` 和 `Etag` 属性同时出现的时候，`Etag` 的优先级更高。

强缓存策略和协商缓存策略在缓存命中时都会直接使用本地的缓存副本，区别只在于协商缓存会向服务器发送一次请求。它们缓存不命中时，都会向服务器发送请求来获取资源。在实际的缓存机制中，强缓存策略和协商缓存策略是一起合作使用的。浏览器首先会根据请求的信息判断，强缓存是否命中，如果命中则直接使用资源。如果不命中则根据头信息向服务器发起请求，使用协商缓存，如果协商缓存命中的话，则服务器不返回资源，浏览器直接使用本地资源的副本，如果协商缓存不命中，则浏览器返回最新的资源给浏览器。

详细资料可以参考：

- [前端优化：浏览器缓存技术介绍](https://juejin.cn/post/6844903672556552205)

### 什么是浏览器的同源政策？

同源策略是值，一个域下的 js 脚本在未经允许的情况下，不能访问另一个域的资源。这里的同源指的是**协议、域名、端口号**都必须相同。

同源策略主要限制了三方面：不能跨域访问 cookie/localStorage/indexDB 数据，不能跨域访问 DOM，不能跨域发起请求。

跨域解决方案有以下几种：

1. JSONP
2. CORS
3. postMessage
4. WebSocket
5. Node 中间件代理
6. Nginx 反向代理
7. window.name+iframe
8. document.domain+iframe
9. location.hash+iframe

详细资料可以参考：

- [前端常见跨域解决方案（全）](https://segmentfault.com/a/1190000011145364)
